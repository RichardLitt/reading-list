function render(e,o){if(render.tmpl_cache||(render.tmpl_cache={}),!render.tmpl_cache[e]){var n,t="/templates",l=t+"/"+e+".html";$.ajax({url:l,method:"GET",async:!1,success:function(e){n=e}}),render.tmpl_cache[e]=_.template(n)}return render.tmpl_cache[e](o)}var hoodie=new Hoodie,app=app||{};app.pubSub=_.extend({},Backbone.Events);var bookCollectionView=new app.BookCollectionView,searchResultsView=new app.SearchResultsView,shelfCollection,shelvesCollectionView;hoodie.store.findAll("shelf").then(function(e){shelfCollection=new app.ShelfCollection(e),shelvesCollectionView=new app.ShelfCollectionView(shelfCollection),hoodie.store.findAll("book").then(function(e){e.forEach(function(e){var o=new app.Book(e);shelfCollection.forEach(function(e){e.get("name")===o.get("shelf")&&(console.log("added %s to %s",o.get("title"),e.get("name")),e.get("nested").add(o))})}),shelvesCollectionView.setIndexAsActive(0)})}),$("#listinput").on("keyup",function(e){var o=e.target.value;if(13===e.keyCode){var n=new app.Shelf({name:o});shelvesCollectionView.addShelf(n),hoodie.store.add("shelf",n.toJSON())}}),$("#bookinput").on("keyup",$.debounce(function(e){var o=e.target.value;o.length>=3&&($("#loading").show(),hoodie.isbn.searchbooks({query:o}).fail(function(){$("#loading").hide()}).done(function(e){$("#loading").hide(),searchResultsView.reset(),searchResultsView.collection.set(e.result.data)}))},555)),$(document).ready(function(){hoodie.goodreads.getinfo({username:hoodie.account.username}).fail(function(){$("#linkToGoodreads").show()}).done(function(e){e.goodreads_exists?$("#linkedToGoodreads").show():$("#linkToGoodreads").show()});var e=$("#linkToGoodreads").attr("href");$("#linkToGoodreads").attr("href",e+"?hoodie_id="+hoodie.account.username)});