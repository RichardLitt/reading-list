var app=app||{};app.Shelf=Backbone.Model.extend({defaults:{name:""},initialize:function(e){this.set("name",e.name),this.set("nested",e.collection||new app.BookCollection),app.pubSub.on("add:shelf",this.addBookToShelf,this),app.pubSub.on("remove:shelf",this.removeBookFromShelf,this)},setActive:function(){this.trigger("setactive",this)},addBookToShelf:function(e){this.get("active")&&(e.set("shelf",this.get("name")),this.get("nested").add(e),hoodie.store.add("book",e.toJSON()).then(function(t){e.set("id",t.id)}))},removeBookFromShelf:function(e){var t=this;t.get("active")&&hoodie.store.remove("book",e.get("id")).then(function(){t.get("nested").remove(e)})}});